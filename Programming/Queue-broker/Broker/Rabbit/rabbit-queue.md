
# Очереди Rabbit

**Связи:**
- Обратные
	- [RabbitMQ](rabbit-mq.md);
- Прямые:

**Хештеги:**
- #Queue/Broker ;
- #Rabbit/Queue

## Общие сведения

Очереди в RabbitMQ мало отличаются от очередей в других брокерах сообщений (рассматривается модель для протокола AMQP 0-9-1). Они хранят сообщения, которые обрабатываются приложениями. Очередь делится некоторыми свойствами с точками обмена, но так же имеет некоторые дополнительные свойства:

- Name (Наименование);
- Durability (Долговечность - очередь пепреживает рестарт брокера);
- Exclusive (очередь может быть использована одним соединением и она будет удалена после закрытия этого соединения)
- Auto-delete (очередь удаляется, когда последний консьюмер отписывается от неё);
- Arguments (опционально, используется плагинами и специфическими фичами брокера, например, TTL, лимит сообщений в очереди и др.).

Перед использованием очереди её нужно объявить. Объявление очереди приведет к её созданию, если она не существовала до этого. Объявление очереди не будет иметь эффекта, если очередь уже создана и её аттрибуты являются такими же. Если существующие аттрибуты очереди отличаются от вновь объявленных, мы получим ошибку уровня канала (channel-level exception) с кодом 406 (`PRECONDITION_FAILED`).

## Наименование очереди

Приложения могут задавать имена очередей или просить брокера сгенерировать для них имя. Имена очередей могут включать до 255 байт символов кодировки UTF-8. Чтобы брокер сгенерировал имя сам, необходимо передать пустую строку в качестве имени очереди. Имя очереди будет возвращено клиенту в ответе на её объявление.

Имена очередей, начинающиеся с префикса `amq.` зарезервированы брокером для внутреннего испоьзования. Попытки объявить очередь с стаким именем самостоятельно приведут к ошибке уровня канала с кодом 403 (`ACCESS_REFUSED`).

## Продолжительность жизни (долговечность)

В AMQP 0-9-1 очереди могут быть объявлены как постоянные или временные. Метаданные постоянной очереди хранятся на диске, а метаданные временной очереди, если это возможно, хранятся в памяти.

То же различие проводится и для сообщений во время публикации.

В средах и случаях использования, где важна надежность (постоянство очередей), приложения должны использовать постоянные очереди и следить за тем, чтобы издатели отмечали опубликованные сообщения как сохраненные.
