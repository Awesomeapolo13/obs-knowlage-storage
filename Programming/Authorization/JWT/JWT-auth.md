
# Авторизация JWT токеном

JSON Web Token (JWT) - интернет стандарт для создания данных с дополнительной подписью и шифрованием. Чаще всего используется как инструмент авторизации и аутентификации пользователя.

## Принцип работы

1) Пользователь с помощью Логина и пароля отправляет запрос аутентификации на сервер (Authorization Server).

2) Сервер возвращает два токена Access token и Refresh token.

![[Pasted image 20221113172627.png]]

3) Клиент отправляет запрос на сервер (Resource Server) с прикрепленным access токеном и получает необходимые ему ресурсы.

4) После истечения времени жизни Access token, пользователь отправляет запрос с Refresh token на аутентификационный сервер.

5) Сервер аутентификации возвращает новую пару Access token и Refresh token.

## Структура токена

Токен представляет собой строку из трех частей, в которой зашифрованы определенные данные:
1) Заголовки;
2) Тело запроса;
3) Подпись в виде комбинированной зашифрованной строки

![[Pasted image 20221113173954.png]]


Сам по себе механизм аутентификации по JWT не требует хранения информации о пользовательских сессиях. Однако, механизм Refresh token требует хранения в БД рефреш токенов.  Это необходимо, чтобы удобно отзывать токены, валидировать сессии и т.д.

## Подпись токенов

Существует несколько способов подписания токенов. С помощью секретного ключа и с помощью пары секретного и публичного ключа (Симметричное и Асиметричное шифромание).
Симметричное шифрование использует один ключ, хранимый на сервере, который можно сообщать клиентам.
Асиметричное шифрование содержит 2 ключа, публичный и привятный. С помощью публичного ключа выполняется проверка подлинности токена, а с помощью приватного ключа выполняется формирование подписи токена. Приватный ключ, как правило, хранится на сервере автоирзации, который занимается выдачей токенов. Публичный же раздаются клиентам, и они самостоятельно проверяют  подлинность токена.

**Более безопасным** является подход **Асимметричного шифрования**.

**Ключи:**
- [Автоиризация](Authorization);
- [Symfony JWT реализация](Symfony-JWT);

**Хештеги:** #Programming/Auth/JWT