# Dependency injection (DI)

**Внедрение зависимостей (Инъекция зависимостей)** - процесс предоставления внешней зависимости программному компоненту.

**Простейший DI** - это передача инстанца класса в конструктор другого.

**Composition root** - создание инстансев классов в некоторой точке приложения/класса, например, в некотором методе. Однако создание объектов выстраивается напрямую через оператор `new`.

## Inversion of control и DIP

**Inversion of control (Инверсия управления)** - принцип когда каждый компонент системы должен быть как можно более изолированным от других, не полагаясь в своей работе на детали конкретной реализации.

**Dependency inversion principle (DIP)** - принцип SOLID, модули верхних уровней не должны испортировать сущности из модулей низших уровней. Оба типа модулей должны зависить от абстракций. Абстракции не должны зависеть от деталей. Детали должны зависеть от абстракций.

## Работа DI с IoC (IoC containers)

![[Pasted image 20230423211204.png]]

1) Классы A и B регистрируются в контейнере при старте приложения. При регистрации им выдаются уникальный токен (классы удовлетворяет некоторому интерфейсу)
2) Когда на необходимо докинуть в другой класс зависимость, контейнер создает инстанс класса B, затем он внедряется как зависимость в класс A, поскольку удовлетворяет интерфейсу B.
3) Изначальный класс A создается аналогично.

## Работа Service locator

![[Pasted image 20230423214004.png]]
1) Регистрируем все сервисы в контейнере
2) Вытаскиваем конкретный инстанс для его использования

Иногда считается антипаттерном, т.к. можно из любой точки взять любую зависимость, что порождает лишнюю связанность.

**Ключи:**
- [Object Oriented Programming](OOP);

**Хештеги:** #Programming/OOP/Patterns