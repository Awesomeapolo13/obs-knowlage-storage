
# Оператор UNION

**Ключи:**
- Обратные:
	- [SQL](SQL);
	- [Реляционные БД](relative);
	- [Операторы](sql-operators);
- Прямые:

**Хештеги:** #Programming/Databases/SQL/Operator

## Описание

Оператор MySQL `UNION` позволяет объединить два или более наборов результатов в один набор результатов.

```sql
SELECT column_list
UNION [DISTINCT | ALL]
SELECT column_list
UNION [DISTINCT | ALL]
SELECT column_list
...
```

Для корректного объединения результатов нескольких запросов необходимо следовать следующим правилам:
- количество и порядок столбцов, которые появляются во всех операторах `SELECT`, должны быть одинаковыми;
- типы данных столбцов должны быть одинаковыми или совместимыми.

Так же, по умолчанию оператор `UNION` удаляет повторяющиеся строки, даже если вы не указали оператор `DISTINCT` явно.

Если же использовать `UNION ALL`, повторяющиеся строки, если они есть в результате, останутся. Поскольку `UNION ALL` не требует обработки дубликатов, он работает быстрее, чем `UNION DISTINCT`.

```sql
SELECT id
FROM t1
UNION ALL
SELECT id
FROM t2;
```

Разница между операторами `UNION` и `JOIN` состоит в том, что `JOIN` комбинирует результаты горизонтально, а `UNION` вертикально. Картинка ниже иллюстрирует это наглядно:

![[Pasted image 20240112115759.png]]

При выводе результатов `UNION` устанавливает имено колонок в соответствии с их именами в верхнем подзапросе. Т.о. можно указать алиасы для колонок только в нем.

Оператор сортировки при UNION необходимо указывать у последнего подзапроса. Его указание в подзапросах выше не приведет к сортировке. Однако в MySQL есть возможность сортировки результата по позиции колонки (например `ORDER By 1`), но это считается плохой правтикой.
