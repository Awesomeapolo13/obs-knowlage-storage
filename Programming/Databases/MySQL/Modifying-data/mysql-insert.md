
# INSERT

**Ключи:**
- Обратные:
	- [MySQL](MySQL);
	- [Модификация данных MySQL](mysql-modifying-data);

**Хештеги:** 
- #Programming/Databases/MySQL/Modify

## Синтаксис

### Вставка одной строки

Оператор INSERT позволяет вставить в таблицу одну или несколько новых строк. Синтаксис инструкции INSERT:

```sql
INSERT INTO table_name(column1, column2,...) VALUES (value1, value2,...);
```

- определяются имя таблицы и колонки через запятую, перед которыми ставится выражение `INSERT INTO`;
- затем после выкажения `VALUES` перечисляются значения для каждой из колонок.


При использовании оператора `INSERT` необходимо убедиться, что количество столбцов соответствует количеству значений. Кроме того, значения для колонок должны быть перечислены в том же порядке, что и сами колонки.

Если необязательные колонки и значения не перечислены, они будут заполнены значениями по умолчанию. Либо же можно указать имя колонки, а в значении - ключевое слово `DEFAULT`.

### Вставка множества строк

Для добавления множества колонок:

```sql
INSERT INTO table(column1, column2,...) 
VALUES 
  (value1, value2,...), 
  (value1, value2,...), 
  ...
  (value1, value2,...);
```

Количество строк для множественной вставки ограничено значением опции `max_allowed_packet`. Добавление большего количества строк вызовет ошибку. Можно проверить значение этой опции:

```sql
SHOW VARIABLES LIKE 'max_allowed_packet';
```

Вывод:

```shell
+--------------------+----------+
| Variable_name      | Value    |
+--------------------+----------+
| max_allowed_packet | 67108864 |
+--------------------+----------+
1 row in set (0.01 sec)
```

Число в столбце «Value» — это количество байтов.

Чтобы установить новое значение для переменной max_allowed_packet, вы используете оператор `SET GLOBAL`:

```sql
SET GLOBAL max_allowed_packet=size;
```

В этом операторе `size` представляет собой целое число - максимально допустимого размера пакета в байтах.

*Следует отметить, что `max_allowed_packet` не влияет на оператор` INSERT INTO .. ​​SELECT`. Выражение `INSERT INTO .. ​​SELECT` может вставлять столько угодно строк.*

Так же при использовании операции `SELECT LAST_INSERT_ID();` после множественной вставки строк, она вернет id первой вставленной строки из всех.

### Вставка DATETIME

Тип данных `DATETIME` испольуется для хранения даты и времени в одной колонке. Перед вставкой данных в колонку типа `DATETIME` нам необходимо привести её к формату `YYYY-MM-DD HH:MM:SS`.

Пример:

```sql
INSERT INTO events(event_name, event_time)
VALUES('MySQL tutorial livestream', '2023-10-28 19:30:35');
```

Если необходимо вставить текущее время и дату, можно использовать функцию `NOW()`:

```sql
INSERT INTO events(event_name, event_time)
VALUES('MySQL Workshop', NOW());
```

Если же необходимо выполнить вставку строки как `DATETIME`, используем функцию `STR_TO_DATE()` для конвертации в требуемый формат:

```sql
INSERT INTO events (event_name, event_time)
VALUES ('MySQL Party', STR_TO_DATE('10/28/2023 20:00:00', '%m/%d/%Y %H:%i:%s'));
```


### Вставка DATE

Тип данных `DATE` испольуется для хранения даты. Перед вставкой данных в колонку типа `DATE` нам необходимо привести её к формату `YYYY-MM-DD`.

Пример:

```sql
INSERT INTO events(event_name, event_date)
VALUES('MySQL Conference','2023-10-29');
```

При попытке вставки невалидной даты, например, при числе 39, будет сгенерирована ошибка.

Если необходимо вставить текущее время и дату, можно использовать функцию `CURRENT_DATE`:

```sql
INSERT INTO events(event_name, event_date)
VALUES('MySQL Replication Workshop', CURRENT_DATE);
```

При необходимости вставлять дату в формате UTC, использем `UTC_DATE()`:

```sql
INSERT INTO events(event_name, event_date)
VALUES('MySQL Day in USA', UTC_DATE());
```

Если же необходимо выполнить вставку строки как `DATE`, используем функцию `STR_TO_DATE()` для конвертации в требуемый формат:

```sql
INSERT INTO events (event_name, event_date)
VALUES ('MySQL Innovate', STR_TO_DATE('10/29/2023', '%m/%d/%Y'));
```

