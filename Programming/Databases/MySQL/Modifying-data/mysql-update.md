
# UPDATE

**Ключи:**
- Обратные:
	- [MySQL](MySQL);
	- [Модификация данных MySQL](mysql-modifying-data);
- Прямые:
	- [UPDATE JOIN](mysql-update-join);
**Хештеги:** 
- #Programming/Databases/MySQL/Modify

## Синтаксис

### Изменение значений

Оператор `UPDATE` позволяет обновить данные в таблице. То есть она изменяет значения одной или более колонок в одной или нескольких строках:

```sql
UPDATE [LOW_PRIORITY] [IGNORE] table_name 
SET 
    column_name1 = expr1,
    column_name2 = expr2,
    ...
[WHERE
    condition];
```

- определяем имя таблицы, для которой обновляем данные;
- в выражении `SET` определяем имена колонок, значения которых хотим изменить, а так же новые значения для них;
- определяем какие строки должны быть обновлены в выражении `WHERE` (это выражение опционально, если пропустить его - обновятся все строки таблицы).

Стоит предельно внимательно работать с выражением `WHERE`. Его не следует забывать, в противном случае будут обновлены лишние строки.

В MySQL предусмотрены два модификатора для `UPDATE`:

- Модификатор `LOW_PRIORITY` указывает оператору `UPDATE` задержать обновление до тех пор, пока не прекратятся соединения для чтения данных из таблицы. `LOW_PRIORITY` вступает в силу для механизмов хранения, которые используют блокировку только на уровне таблицы, таких как `MyISAM`, `MERGE` и `MEMORY`.
- Модификатор `IGNORE` позволяет оператору `UPDATE` продолжать обновление строк даже в случае возникновения ошибок. Строки, вызывающие ошибки, например конфликты дубликатов ключей, не обновляются.

### Изменение данных с заменой

Можно выполнить частичную модификацию колонок в строках используя функцию `REPLACE()`. Например запрос ниже меняет доменные части электронной почты:

```sql
UPDATE employees
SET email = REPLACE(email,'@classicmodelcars.com','@mysqltutorial.org')
WHERE
   jobTitle = 'Sales Rep' AND
   officeCode = 6;
```

### Изменение данных из `SELECT`

Как и в случае с `INSERT` можно использовать выражения `SELECT` как источник данных для новых величин:

```sql
UPDATE customers 
SET 
    salesRepEmployeeNumber = (SELECT 
            employeeNumber
        FROM
            employees
        WHERE
            jobtitle = 'Sales Rep'
        ORDER BY RAND()
        LIMIT 1)
WHERE
    salesRepEmployeeNumber IS NULL;
```
