
# Нормализация данных

**Ключи:**
- Обратные:
	- [Базы данных](databases);
- Прямые:
	- [Денормализация данных](data-denormalization.md);

**Хештеги:** #Programming/Databases/Normalization

## Определение

**Нормализация данных** – это процесс приведения данных к определенному стандарту или формату, чтобы улучшить их качество и эффективность обработки.

**Нормализация данных в БД** - процесс организации структуры данных для уменьшения избыточности и улучшения целостности данных. Достигается это разделением информации на несколько связанных таблиц.

## Принципы и этапы

1) **Первая нормальная форма (1NF)**:
	- Устранение дублирующих групп: Данные должны быть представлены в виде таблицы, где каждая колонка содержит атомарные (неделимые) значения, а каждая строка уникальна.
	- Уникальный идентификатор: Каждая таблица должна иметь первичный ключ, уникально идентифицирующий каждую строку.
2) **Вторая нормальная форма (2NF)**
	- Устранение частичных зависимостей: Достигается для таблиц, которые уже находятся в 1NF. Таблица находится в 2NF, если все не ключевые атрибуты полностью зависят от первичного ключа. Частичная зависимость - когда атрибут в таблице зависит только от части первичного ключа (например оценка за курс студента зависит от id студента и id курса, а имя только от id студента). Проще говоря такие зависимости нужно разделить на разные таблицы.
3) **Третья нормальная форма (3NF)**
	- Устранение транзитивных зависимостей: Таблица должна быть в 2NF и все её атрибуты должны быть непосредственно зависимы от первичного ключа, а не через другие атрибуты. Транзитивная зависимость - это когда в таблице один атрибут зависит от второго через третий. Например, когда мы храним информацию о департаментах (`department_id`, `department_name`) вместе с сотрудниками, есть транзитивная зависимость `department_name` от `employee_id` через `department_id` (если два сотрудника работают в одном отделе, то имя отдела придется дублировать).  Решается так же разделением этих атрибутов на разные таблицы в БД.
4) **Бойса-Кодда нормальная форма (BCNF): **
	- Усиление 3NF, где каждый детерминант является кандидатом в первичные ключи. Детерминант - атрибут или группа атрибутов, от которых зависят другие атрибуты в таблице. Проще говоря, каждый атрибут, который является частью ключа, должен быть функционально зависимым только от ключевых атрибутов, и не должно быть такого, что неключевой атрибут функционально определяет ключевые атрибуты.
5) **Четвертая нормальнае форма (4NF):**
	- Это уровень нормализации баз данных, который дополнительно устраняет нежелательные аномалии, возникающие из-за многозначных зависимостей в таблице.
	- Чтобы таблица соответствовала 4NF, она должна быть в BCNF и все многозначные зависимости должны быть тривиальными. То есть, таблица не должна содержать многозначных зависимостей (когда один ключ определяет множество значений нескольких других независимых атрибутов) за исключением случаев, когда эти зависимые атрибуты функционально зависят от ключа.
	- Для примера представим таблицу `ПреподавательКлассХобби`, в которой `Преподаватель` и `Класс` определяют `Хобби`, но `Хобби` не зависит от `Класса` (и наоборот). Это пример многозначной зависимости, где `Преподаватель -> Хобби` и `Преподаватель -> Класс` независимы друг от друга. Таблица не находится в 4NF из-за этих многозначных зависимостей.

| Преподаватель | Класс      | Хобби     |
| ------------- | ---------- | --------- |
| Иванов        | Математика | Шахматы   |
| Иванов        | Математика | Плавание  |
| Петров        | История    | Чтение    |
| Петров        | История    | Велоспорт |
- Для приведения таблицы к 4NF её нужно разделить так, чтобы избежать многозначных зависимостей, а именно разделить на `ПреподавательКласс` и `ПреподавательХобби`, с преподавателем к качестве первичного ключа у обоих таблиц.

6) **Пятая нормальные формы (5NF) или проекционно-соединительная нормальная форма (PJNF):**
	- Уровень нормализации БД, который устраняет избыточность данных за счет разделения таблиц на более мелкие, связанные только через соединения (JOINs).
	- Таблица считается находящейся в 5NF, если она не может быть разделена на более мелкие таблицы без потери данных при соединении этих таблиц обратно. Другими словами, таблица находится в 5NF, если она может быть реконструирована из своих более мелких частей с использованием операций соединения, без введения избыточности.

## Цели

1) Уменьшение избыточности - избегание повторения данных.
2) Улучшение целостности - обеспечение точности и последовательности данных.
3) Оптимизация запросов - улучшение производительности за счет более эффективных запросов.

## Замечания

1) **Производительность:** Иногда для улучшения произзводительности запросов, особенно в больших и сложных системах, используют Денормализацию.
2) **Практическое применение:** Не всегда необходимо достигать высших нормальных форм, особенно если это приводит к чрезмерному усложнению структуры БД.