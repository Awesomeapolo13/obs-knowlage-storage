
# Механизмы управления процессами

**Связи:**
- Обратные
	- [PHP-FPM](php-fpm);
- Прямые:
	

**Хештеги:** #Programming/PHP/PHP-FPM

## Static - Статический режим

Постоянное количество процессов.

```ini
pm = static
pm.max_children = 20
```

**Характеристики:**

- создает фиксированное количество процессов при старте;
- процессы живут до остановки PHP-FPM;
- самый быстрый отклик - нет задержек на создание процессов;
- постоянное потребление памяти;
- идеально для высоконагруженных сайтов с постоянным трафиком.

## Dynamic - Динамический режим

Всегда есть некоторое постоянное значение процессов, но в моменты высоких нагруок выделяются дополнительные:

```ini
pm = dynamic
pm.max_children = 50# Максимум процессов
pm.start_servers = 8# Стартовое количество
pm.min_spare_servers = 5 # Минимум свободных
pm.max_spare_servers = 15 # Максимум свободных
pm.process_idle_timeout = 10s
```

**Характеристики:**

- при старте создается количество процессов равное `pm.start_servers`;
- если свободных процессов меньше `pm.min_spare_servers` создаются новые;
- если свободных больше `pm.max_spare_servers` лишние завершаются;
- максимальное количество процессов ограничено `pm.max_children`.

Преимущество этого режима в том, что он адптируется к нагрузке и экономит память при низкой нагрузке.

## OnDemand - По требованию

Процессы создаются по запросу.

```ini
pm = ondemand
pm.max_children = 30
pm.process_idle_timeout = 10s
```

**Характеристики:**

- процессы создаются только при поступлении запросов;
- процессы завершаются после  `pm.process_idle_timeout` простоя;
- минимальное потребление памяти в простое;
- небольшая задержка на первый звпрос после простоя;
- подходит для сайтов с низким/неравномерным трафиком.
