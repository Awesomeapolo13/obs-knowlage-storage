
# Протокол HTTP

**Ключи:**
- Обратные:
	- [Протоколы передачи данных](protocol);
- Прямые:
	- [TCP-протокол](tcp-protocol);
	- [URI, URN, URL](uri-urn-url);
	- [Заголовки HTTP](http-headers);
	- [Методы HTTP](http-method);

**Хештеги:**
- #Protocol/HTTP

## Определение

HTTP (HyperText transfer Protocol - протокол передачи гипертекста) - протокол прикладного уровня передачи данных, изначально в виде гипертекстовых документов в формате HTML, в настоящее время используется для передачи произвольных данных.

Факты:
- текстовый протокол одностороннего свойства;
- в основе лежит технология "клиент-сервер";
- Stateless - не отвечает за сохранение состояния.

## Структура

![[Pasted image 20240805184008.png]]

**Первая строка** - какой метод используется, к чему обращается, версия протокола.
**HTTP-headers** - разное количество, но обязательно Host.
**Пустая строка** - отделяем её тело сообщения.
**Тело сообщения** - разного рода данные.

Примеры с HTTP bin. Слева - запроса, справа - ответ.

![[Pasted image 20240805184422.png]]

## Версия

- HTTP 0.9 (1992);
- HTTP/1.0 (1996, RFC 1945)$
- HTTP/1.1 (1999);
- HTTP/2 (2015) (SPDY by Google);
- HTTP/3 (RFC 9114 Proposed standart).

Модель OCI ниже:

![[Pasted image 20240805162132.png]]

TCP находится на урове TRANSPORT модели TCP/IP, а HTTP на уровне APPLICATION.

### HTTP 0.9

- Только метод GET;
- Один запрос = открытие нового соединения TCP.

### HTTP/1.0

- Необходимость указания версии протокола;
- Добавилось больше методов (POST, HEAD);
- Появились заголовки;
- Благодаря Content-type можем передавать не только HTML.

### HTTP/1.1

Наиболее распространенная версия, привела к массовому использованию HTTP.

- Добавилось больше методов (PUT, PATCH, DELETE);
- Обязательный заголовок Host (раньше одна машина обслуживала один хост, хостов стало больше, и теперь стало необходимым определить на какой хост у машины отправить запрос);
- Нет ожидания каждого запроса (HTTP pipeline) (редко правильно реализован) - можно пропустить другие запросы, а не ждать завершения тяжелого запроса (не используется или отключен в браузере);
- Появился keep-alive, то есть переиспользование TCP-соединения (раньше соединение закрывалось сразу после завершения запроса, а количество одновременных соединений, как правило, не больше трех);
- Для идетификации ресурса использует URI;
- Определяет как взаимодействует между собой клиент и сервер;
- Определяет как запрашивается и передается контент (нужно перейти на другую страницу, какой алгоритм сжатия использовать, какой размер запроса).

### HTTP/2

Серьезный прорыв с множеством хороших вещей.

- Бинарный с автоматическим сжатием (с помощью GZIP);
- Мультиплексинг - обработка разных пользаков через один коннект;
- Решение HOLB (Head Of Line Blocking) на уровне Application - по сути запросы встают в очереди и тяжелый запрос будет держать всех, эта проблема решается на стороне приложения (ответ на тяжелый запрос отдается, когда он закончит обработку, другие же запросы в это время обслуживаются как обычно);
- Приоритезация - указание приоритетов для запросов (например, получить стили и js файлы поскорее);
- Сжатие заголовков;
- Server push - например, запрашиваем страницу с html, на ней ссылки на css и js,  он позволяет все это поскорее получить;
- Connection Reset - особенно актуально для мобильной связи;
- Все хорошо, но упирается в TCP.

### HTTP/3

Серьезный прорыф с множеством хороших вещей.

- UDP вместо TCP;
- QUIC - берет на себя решение проблем  UDP (надежность);
- Производительнее;
- Разрешен HOLB (Head of Line Blocking - проблема TCP).

![[Pasted image 20240805190329.png]]

## Заголовки

См. прямые ссылки ссылки.

## HTTPS

**HTTPS (та же расшифровка + S - Secure)** - расширение протокола HTTP для поддержки шифрования в целях повыщения безопасности. Данные передаются поверх криптографических протоколов SSL или TLS. Используется порт 443.

Особенности:
- является тем же что и HTTP;
- Для установки соединения необходим обмен ключами (фсинхронно вначале, далее синхронно).

**SSL (Secure Socket Layer - уровень защитщённых сокетов)** - криптографический протокол, который подразумевает более безопасную связь.
- используется асимметричную криптографию для аутентификации ключей обмена;
- симметричная криптография для сохранения конфиденциальности;
- в 2014 году правительство США сррбщило об его уязвимости;
- SSL  должен быть заменен на TLS.

**TLS (Transport Layer Security - протокол защиты ьранспортного уровня)** - криптографический протокол, основанный на SSL 3.0.
- используется асимметричную криптографию для аутентификации ключей обмена;
- симметричная криптография для сохранения конфиденциальности;
- т.е. TLS это следующая итерация SSL. 

Чтобы только лишь начать обмен данными по HTTPS нужно совершить действия на рисунке ниже (потратить почти секунду):

![[Pasted image 20240806105220.png]]

